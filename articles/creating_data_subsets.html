<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating data subsets • MolgenisArmadillo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating data subsets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MolgenisArmadillo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/MolgenisArmadillo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/create_resources.html">Create resources</a></li>
    <li><a class="dropdown-item" href="../articles/creating_data_subsets.html">Creating data subsets</a></li>
    <li><a class="dropdown-item" href="../articles/install_packages.html">Install packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/molgenis/molgenis-r-armadillo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating data subsets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/molgenis/molgenis-r-armadillo/blob/chore/ci-svu-update/vignettes/creating_data_subsets.Rmd" class="external-link"><code>vignettes/creating_data_subsets.Rmd</code></a></small>
      <div class="d-none name"><code>creating_data_subsets.Rmd</code></div>
    </div>

    
    
<p>When researchers request access to your data they may not be granted
access to the whole dataset, but only to the variables which they will
use in their project. In Armadilllo, access is regulated on the project
level, so you will need to create a view containing only these
variables.</p>
<div class="section level2">
<h2 id="install-and-load-the-package">Install and load the package<a class="anchor" aria-label="anchor" href="#install-and-load-the-package"></a>
</h2>
<p>You first need to install and load the package to be able to create
the subsets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"MolgenisArmadillo"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/molgenis/molgenis-r-armadillo/" class="external-link">MolgenisArmadillo</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logging-in">Logging in<a class="anchor" aria-label="anchor" href="#logging-in"></a>
</h2>
<p>In order to access the files, you need to log in using the URL of the
Armadillo server. A browser window will be opened where you can identify
yourself with the ID provider.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.login.html">armadillo.login</a></span><span class="op">(</span><span class="st">"https://armadillo-demo.molgenis.net/"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "We're opening a browser so you can log in with code 5FLGYF"</span></span></code></pre></div>
<p>A session will be created and the credentials stored in the
environment.</p>
</div>
<div class="section level2">
<h2 id="creating-the-subset">Creating the subset<a class="anchor" aria-label="anchor" href="#creating-the-subset"></a>
</h2>
<p>Let’s assume you are in a consortium which has data that can not be
shared in entirety to researchers. You want to share a subset of the
whole dataset with certain researchers that applied for access to your
data. There are two ways that you can do this.</p>
<div class="section level3">
<h3 id="specify-the-required-variables-in-a-separate--csv-file-">Specify the required variables in a separate .csv file.<a class="anchor" aria-label="anchor" href="#specify-the-required-variables-in-a-separate--csv-file-"></a>
</h3>
<p>For each research project, you first create a .csv file containing 5
columns:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="17%">
<col width="20%">
<col width="19%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>source_folder</th>
<th>source_table</th>
<th>target_folder</th>
<th>target_table</th>
<th>variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2_1_core_1_0</td>
<td>yearly_rep</td>
<td>project1</td>
<td>yearly_vars</td>
<td>green_dist_</td>
</tr>
<tr class="even">
<td>2_1_core_1_0</td>
<td>yearly_rep</td>
<td>project1</td>
<td>yearly_vars</td>
<td>green_size_</td>
</tr>
<tr class="odd">
<td>2_1_core_1_0</td>
<td>yearly_rep</td>
<td>project1.</td>
<td>yearly_vars</td>
<td>green_access_</td>
</tr>
</tbody>
</table>
<p>‘source_folder’ refers a folder within the master project;
‘source_table’ refers to the name of a table within this folder,
‘target_folder’ refers to the name for the new folder within the target
project, ‘target_table’ refers to the name of the new table within
‘target_folder’ and ‘variable’ refers to one or more variables within
source_table (‘source_project’ and ‘target_project’ are specified
later).</p>
<p>Note that these columns need to be named exactly as above.</p>
<p>Once you have defined the tables then you can construct the
’<code>subset_definition</code>. This creates a tibble within R holding
the details from the .csv file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset_definition</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/armadillo.subset_definition.html">armadillo.subset_definition</a></span><span class="op">(</span></span>
<span>  reference_csv <span class="op">=</span> <span class="st">"data/subset/vars.csv"</span><span class="op">)</span></span>
<span><span class="va">subset_definition</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   source_folder   source_table target_folder target_table target_vars      </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;           </span></span>
<span><span class="co">#&gt; 1 2_1-core-1_0    yearlyrep    core          year_rep     &lt;tibble [14 × 1]&gt;</span></span>
<span><span class="co">#&gt; 2 1_1-outcome-1_0 yearlyrep    outcome       year_rep     &lt;tibble [9 × 1]&gt; </span></span>
<span><span class="co">#&gt; 3 2_1-core-1_0    nonrep       core          non_rep      &lt;tibble [5 × 1]&gt;</span></span></code></pre></div>
<p>After this you can create a new subset using the subset method within
Armadillo.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.subset.html">armadillo.subset</a></span><span class="op">(</span></span>
<span>  input_source <span class="op">=</span> <span class="st">"subset_def"</span>,</span>
<span>    source_project <span class="op">=</span> <span class="st">"gecko"</span>,</span>
<span>    target_project <span class="op">=</span> <span class="st">"study1"</span>,</span>
<span>    subset_def <span class="op">=</span> <span class="va">subset_definition</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Created project 'study1' without users</span></span>
<span><span class="co">#&gt; ✔ All views were successfully created!</span></span>
<span><span class="co">#&gt; ✔ View 'core/year_rep' successfully created</span></span>
<span><span class="co">#&gt; ✔ View 'outcome/year_rep' successfully created</span></span>
<span><span class="co">#&gt; ✔ View 'core/non_rep' successfully created</span></span></code></pre></div>
<p>This method is generally the best choice if you need to create
subsets for multiple tables.</p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-the-subset-via-arguments">Specifying the subset via arguments<a class="anchor" aria-label="anchor" href="#specifying-the-subset-via-arguments"></a>
</h2>
<p>An alternative is to specify the subset in R, via arguments to the
<code>armadillo.subset</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.subset.html">armadillo.subset</a></span><span class="op">(</span></span>
<span>  input_source <span class="op">=</span> <span class="st">"arguments"</span>,</span>
<span>    source_project <span class="op">=</span> <span class="st">"gecko"</span>,</span>
<span>    source_folder <span class="op">=</span> <span class="st">"2_1-core-1_0"</span>, </span>
<span>    source_table <span class="op">=</span> <span class="st">"yearlyrep"</span>,</span>
<span>    target_project <span class="op">=</span> <span class="st">"study2"</span>,</span>
<span>    target_folder <span class="op">=</span> <span class="st">"core"</span>,</span>
<span>    target_table <span class="op">=</span> <span class="st">"year_rep"</span>, </span>
<span>    target_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"occup_f1_"</span>, <span class="st">"occupcode_f2_"</span>, <span class="st">"edu_f1_"</span>, <span class="st">"edu_f1_fath"</span>, <span class="st">"edu_f2_"</span>, <span class="st">"edu_f2_fath"</span>, <span class="st">"pets_"</span>, <span class="st">"cats_"</span>, <span class="st">"cats_quant_"</span>, <span class="st">"dogs_"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Created project 'study2' without users</span></span>
<span><span class="co">#&gt; ✔ All views were successfully created!</span></span>
<span><span class="co">#&gt; ✔ View 'core/year_rep' successfully created</span></span></code></pre></div>
<p>This method may be easier if you only need to create one small
subset.</p>
<div class="section level3">
<h3 id="checking-subsets">Checking subsets<a class="anchor" aria-label="anchor" href="#checking-subsets"></a>
</h3>
<p>Now you can also take a look at the files in the armadillo user
interface, if you open it in a browser window.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mariska Slofstra, Sido Haakma, Tommy de Boer, Fleur Kelpin, Morris Swertz, Tim Cadman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
