<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MolgenisArmadillo • MolgenisArmadillo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MolgenisArmadillo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MolgenisArmadillo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MolgenisArmadillo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/create_resources.html">Create resources</a></li>
    <li><a class="dropdown-item" href="../articles/creating_data_subsets.html">Creating data subsets</a></li>
    <li><a class="dropdown-item" href="../articles/install_packages.html">Install packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/molgenis/molgenis-r-armadillo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MolgenisArmadillo</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/molgenis/molgenis-r-armadillo/blob/fix/subset-warning/vignettes/MolgenisArmadillo.Rmd" class="external-link"><code>vignettes/MolgenisArmadillo.Rmd</code></a></small>
      <div class="d-none name"><code>MolgenisArmadillo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/molgenis/molgenis-r-armadillo/" class="external-link">MolgenisArmadillo</a></span><span class="op">)</span></span></code></pre></div>
<p>To share your data using Armadillo, you can see the different
relevant steps you can take before the shared data can be transferred to
the researchers.</p>
<div class="section level2">
<h2 id="login">Login<a class="anchor" aria-label="anchor" href="#login"></a>
</h2>
<p>In order to access the files as a data manager, you need to log in.
The login method needs the URLs of the Armadillo server and the MinIO
fileserver. It will open a browser window where you can identify
yourself with the ID provider.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.login.html">armadillo.login</a></span><span class="op">(</span><span class="st">"https://armadillo-demo.molgenis.net/"</span><span class="op">)</span></span></code></pre></div>
<p>It will create a session and store the credentials in the
environment.</p>
</div>
<div class="section level2">
<h2 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h2>
<p>If you need to share data via Armadillo you can have a nested
structure to save you data.</p>
<p>We distinguish:</p>
<ul>
<li>projects</li>
<li>folders</li>
<li>tables</li>
</ul>
<div class="section level3">
<h3 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h3>
<p>Projects are a sort of root-folders you can give persons permissions
on. you can imagine that you will use a seperate project for each study
you need to support. This way you make sure people can not see
eachothers variables.</p>
</div>
<div class="section level3">
<h3 id="folders">Folders<a class="anchor" aria-label="anchor" href="#folders"></a>
</h3>
<p>Folder objects can be used to version the different tables you want
to share in Armadillo. This is not mandatory and are free to use the
folder level as you see fit. In our examples we will go into the
versioning part a bit deeper.</p>
</div>
<div class="section level3">
<h3 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<p>Tables are actual tables in R which contain the data you want to
share. This can be all the data on a certain subject, mostly used in
consortia or a specific study you want to expose.</p>
</div>
</div>
<div class="section level2">
<h2 id="sharing-data">Sharing data<a class="anchor" aria-label="anchor" href="#sharing-data"></a>
</h2>
<p>Let’s asume you are in a consortia which has core-variables and
outcome-variables. You want to share and version the whole dataset to
all researchers which applied to access your data.</p>
<p>First we will create the project. In our case “cohort1”.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.create_project.html">armadillo.create_project</a></span><span class="op">(</span><span class="st">"cohort1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Created project 'cohort1'</span></span></code></pre></div>
<p>Secondly we will load the table(s) we want to upload to Armadillo in
the R-environment. We have test data which is in <code>arrow</code>
format, the upload will take any object that has a table like structure
to upload into the Armadillo. This can be SPSS, STATA, SAS or R-based
data as well.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'arrow'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     timestamp</span></span>
<span></span>
<span><span class="co"># load the core data</span></span>
<span><span class="va">nonrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/core/nonrep.parquet"</span><span class="op">)</span></span>
<span><span class="va">yearlyrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/core/yearlyrep.parquet"</span><span class="op">)</span></span>
<span><span class="va">monthlyrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/core/monthlyrep.parquet"</span><span class="op">)</span></span>
<span><span class="va">trimesterrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/core/trimesterrep.parquet"</span><span class="op">)</span></span></code></pre></div>
<p>The third step is determining the second level, which contains in
this case the datamodel-version the type of variables and the
data-version.</p>
<p>y_y-#variable-type#-x_x</p>
<p>y_y = datamodel version x_x = data version</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># upload the core variables</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="va">nonrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 2_1-core-1_0/nonrep</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="va">yearlyrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 2_1-core-1_0/yearlyrep</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="va">monthlyrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 2_1-core-1_0/monthlyrep</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="va">trimesterrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 2_1-core-1_0/trimesterrep</span></span></code></pre></div>
<p>If you have more tables containing the same naming scheme you need to
drop the data frames in memory and then you can reassign them. See the
example below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drop the old assignments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">nonrep</span>, <span class="va">yearlyrep</span>, <span class="va">monthlyrep</span>, <span class="va">trimesterrep</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load the outcome data</span></span>
<span><span class="va">yearlyrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/outcome/yearlyrep.parquet"</span><span class="op">)</span></span>
<span><span class="va">nonrep</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"data/outcome/nonrep.parquet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># upload the outcome variables</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"1_1-outcome-1_0"</span>, <span class="va">nonrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 1_1-outcome-1_0/nonrep</span></span>
<span><span class="fu"><a href="../reference/armadillo.upload_table.html">armadillo.upload_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"1_1-outcome-1_0"</span>, <span class="va">yearlyrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compressing...</span></span>
<span><span class="co">#&gt; Uploaded 1_1-outcome-1_0/yearlyrep</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="looking-at-the-data">Looking at the data<a class="anchor" aria-label="anchor" href="#looking-at-the-data"></a>
</h2>
<p>There are helper functions to help you determine what is in the
storage server. You can list projects and tables to what’s in the
storage.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># listing tables per project</span></span>
<span><span class="fu"><a href="../reference/armadillo.list_projects.html">armadillo.list_projects</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "longitools"   "genr"         "gecko"        "test"         "omics"       </span></span>
<span><span class="co">#&gt;  [6] "trajectories" "inma"         "subset13"     "cohort1"      "study1"</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># listing tables per project</span></span>
<span><span class="fu"><a href="../reference/armadillo.list_tables.html">armadillo.list_tables</a></span><span class="op">(</span><span class="st">"cohort1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "cohort1/2_1-core-1_0/trimesterrep" "cohort1/2_1-core-1_0/nonrep"      </span></span>
<span><span class="co">#&gt; [3] "cohort1/2_1-core-1_0/yearlyrep"    "cohort1/2_1-core-1_0/monthlyrep"  </span></span>
<span><span class="co">#&gt; [5] "cohort1/1_1-outcome-1_0/nonrep"    "cohort1/1_1-outcome-1_0/yearlyrep"</span></span></code></pre></div>
<p>You can download the data in the R-environment as well.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download table to local R environment</span></span>
<span><span class="va">trimesterrep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/armadillo.load_table.html">armadillo.load_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="st">"trimesterrep"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check the column names from the local environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trimesterrep</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "row_id"        "child_id"      "age_trimester" "smk_t"        </span></span>
<span><span class="co">#&gt; [5] "alc_t"</span></span></code></pre></div>
<p>Now you can also take a look at the files in the user interface of
the MinIO fileserver if you open the MinIO server URL in a browser
window.</p>
</div>
<div class="section level2">
<h2 id="deleting-the-data">Deleting the data<a class="anchor" aria-label="anchor" href="#deleting-the-data"></a>
</h2>
<p>To delete the data you need to throw away the contents first.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># throw away the core tables</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="st">"nonrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '2_1-core-1_0/nonrep'</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="st">"yearlyrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '2_1-core-1_0/yearlyrep'</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="st">"trimesterrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '2_1-core-1_0/trimesterrep'</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"2_1-core-1_0"</span>, <span class="st">"monthlyrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '2_1-core-1_0/monthlyrep'</span></span>
<span></span>
<span><span class="co"># throw away the outcome tables</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"1_1-outcome-1_0"</span>, <span class="st">"nonrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '1_1-outcome-1_0/nonrep'</span></span>
<span><span class="fu"><a href="../reference/armadillo.delete_table.html">armadillo.delete_table</a></span><span class="op">(</span><span class="st">"cohort1"</span>, <span class="st">"1_1-outcome-1_0"</span>, <span class="st">"yearlyrep"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted '1_1-outcome-1_0/yearlyrep'</span></span></code></pre></div>
<p>Now you can delete the project.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/armadillo.delete_project.html">armadillo.delete_project</a></span><span class="op">(</span><span class="st">"cohort1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deleted project 'cohort1'</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mariska Slofstra, Sido Haakma, Tommy de Boer, Fleur Kelpin, Morris Swertz, Tim Cadman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
