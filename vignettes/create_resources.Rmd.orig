---
title: "Create resources"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Create resources}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(MolgenisArmadillo)
```

If you want to perform "omics"-like you need to upload the data to perform the resources. By default, within the Armadillo you can upload files up to 500MB.
If you need to upload larger resources, please contact molgenis-support@umcg.nl.

There are 2 roles you can assume using the package. The datamanager role and the researcher role.

## Datamanager
The datamanager needs to make the data available to the researchers. Besides this you need to create the resources to access the data.

### Upload the data
You need to access the Minio webinterface to be able to access the resource.

1. We are using data from the following sources:
  - https://github.com/isglobal-brge/brge_data_large/blob/master/data/gse66351_1.rda
  - https://github.com/isglobal-brge/brge_data_large/blob/master/data/gse66351_2.rda
2. Login with your institute account.
3. Create a project. For example `omics`.
4. Click on the edit project button to the right of the name of your project.
5. Create a new folder for your data. For example `ewas`.
6. Click on the "Select a file to upload" button or drag your file to upload to the box and click on "Upload". Upload the omics data.

Done!

### Upload the resources
You first need to login to the Armadillo (as `superuser`)


```{r, login to the armadillo server}
armadillo.login("https://armadillo3.demo.molgenis.net")
```

#### Install prerequisites
If you want to install a package on the Armadillo Rserver you can execute the following endpoint. The selected profile is always `default` if none is specified. If your profile doesn't have the `resourcer` package installed, install it and include the library:

```{r, install resourcer package}
install.packages("resourcer")
library(resourcer)
```

#### Create resources
In order to be able to asign the data uploaded in the Minio you need to create the resources as well.

```{r, create s3 file resources}
resGSE1 <- resourcer::newResource(
  name = "GSE66351_1",
  url = "https://armadillo3.demo.molgenis.net/storage/projects/omics/objects/ewas%2Fgse66351_1.rda",
  format = "ExpressionSet"
)
resGSE2 <- resourcer::newResource(
  name = "GSE66351_1",
  url = "https://armadillo3.demo.molgenis.net/storage/projects/omics/objects/ewas%2Fgse66351_1.rda",
  format = "ExpressionSet"
)

armadillo.upload_resource(project="omics", folder="ewas", resource = resGSE1, name = "GSE66351_1")
armadillo.upload_resource(project="omics", folder="ewas", resource = resGSE2, name = "GSE66351_2")
```

The data is now available for researcher to assign.
